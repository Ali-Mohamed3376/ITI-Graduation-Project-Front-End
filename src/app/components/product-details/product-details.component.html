<section class="single-product m-5" *ngIf="product">
  <div class="container">
    <div class="row">
      <div class="col-md-5">
        <div class="single-product-slider">
          <div id="single-product-slider" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner">
              <div class="carousel-item active">
                <div *ngIf="product.price != product.priceAfter" class="sale">{{ product.discount }}% OFF</div>
                <!-- <img src="{{ product.image }}" alt="" class="img-fluid" /> -->
                <div id="carouselExampleControls" class="carousel slide" data-bs-ride="carousel">
                  <div class="carousel-inner">
                    <div *ngFor="let i of product.images" class="carousel-item active">
                      <img src="{{i}}" class="d-block w-100" alt="...">
                    </div>
                    
                  </div>
                  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                  </button>
                  <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                  </button>
                </div>
              </div>
            </div>
            
          </div>
     
        </div>
      </div>
    
      <div class="col-md-7">
        <div class="single-product-details mt-5 mt-lg-0">
          <h2>{{ product.name }}</h2>
          <hr />
          <h4 class="product-price">${{ product.priceAfter }}</h4>
          <h5 *ngIf="product.price != product.priceAfter" class="oldPrice">${{product.price }}</h5>
          <p class="product-description my-4">
            <strong>Description : </strong>{{ product.description }}
          </p>
          <div class="products-meta mt-4">
            <div class="product-category">
              <span class="font-weight-bold text-capitalize product-meta-title">
                <strong>Brand :</strong> {{ product.categoryName }}
              </span>
              <br />
              <span class="font-weight-bold text-capitalize product-meta-title">
                <strong>Model :</strong> {{ product.model }}
              </span>
            </div>
            <form class="cart" action="#" method="post">
              <div class="quantity d-flex align-items-center">
                <div class="form-outline">
                  <label class="form-label" for="form1"><strong>Quantity </strong></label>
                  
                  <select [(ngModel)]="ProductQuantity"     id="form1"  name="quantity"  class="input-text qty text form-control w-25 mr-3"   class="form-select form-select-lg mb-3" aria-label=".form-select-lg example">
                    <option selected value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                  </select>
                </div>

                <button href="#" class="btn btn-primary btn-small m-3" (click)="AddProductToUserCart()">
                  <i class="fa-solid fa-cart-shopping"></i>Add to cart </button>
                
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-12">
        <nav class="product-info-tabs wc-tabs mt-5 mb-5">
          <div class="nav nav-tabs nav-fill" id="nav-tab" role="tablist">
            <a
              class="nav-item nav-link active"
              id="nav-home-tab"
              data-bs-toggle="tab"
              href="#nav-home"
              role="tab"
              aria-controls="nav-home"
              aria-selected="true"
              (click)="openTab('nav-home')"
              >Description</a
            >
            <a
              class="nav-item nav-link"
              id="nav-profile-tab"
              data-bs-toggle="tab"
              href="#nav-profile"
              role="tab"
              aria-controls="nav-profile"
              aria-selected="false"
              (click)="openTab('nav-profile')"
              >Specifications</a
            >
            <a
              class="nav-item nav-link"
              id="nav-contact-tab"
              data-bs-toggle="tab"
              href="#nav-contact"
              role="tab"
              aria-controls="nav-contact"
              aria-selected="false"
              (click)="openTab('nav-contact')"
              >Reviews({{ product.reviewCount }})</a
            >
          </div>
        </nav>

        <div class="tab-content" id="nav-tabContent">
          <div
            class="tab-pane fade show active"
            id="nav-home"
            role="tabpanel"
            aria-labelledby="nav-home-tab"
          >
            <p>{{ product.description }}</p>
          </div>

          <div
            class="tab-pane fade"
            id="nav-profile"
            role="tabpanel"
            aria-labelledby="nav-profile-tab"
          >
            <table class="table table-bordered">
              <tbody>
                <tr>
                  <th scope="row">Brand</th>
                  <td>{{ product.categoryName }}</td>
                </tr>
                <tr>
                  <th scope="row">Model</th>
                  <td>{{ product.model }}</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div
            class="tab-pane fade "
            id="nav-contact"
            role="tabpanel"
            aria-labelledby="nav-contact-tab"
          >
          <!--  -->
          <div class="container text-center">
            <div class="row mb-3 mb-md-0">
              <div class="card col-md-12 col-sm-12 m-1" *ngFor="let review of product.reviews" >
                <div class="card-body py-4 mt-1">
                  <div class="d-flex justify-content-center mb-4">
                    <img src="https://th.bing.com/th/id/R.e04324c4c16de8ecfae1959194e89b5b?rik=WMWd0BXqfVYyow&riu=http%3a%2f%2fcdn.onlinewebfonts.com%2fsvg%2fimg_227643.png&ehk=P4zMEPJ5NQ9erjCrTStGhLW2S5hhsHxFY31p3xvWzEE%3d&risl=&pid=ImgRaw&r=0"
                      class="rounded-circle shadow-1-strong" width="100" height="100" />
                  </div>
                  <h5 class="font-weight-bold">{{ review.fName }} {{ review.lName }}</h5>
                  <h6 class="font-weight-bold my-3">{{ review.formattedCreationDate }}</h6>
                  <ul class="list-unstyled d-flex justify-content-center">
                    <li *ngFor="let star of getReviewStars(review.rating)">
                      <i class="fas fa-star fa-sm text-warning"></i>
                    </li>
                  </ul>
                  <p class="mb-2">
                    <i class="fas fa-quote-left pe-2"></i>{{ review.comment }}
                  </p>
                </div>
              </div>
            </div>
          
            <!--  -->
          </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  </section>
<!-- *********************************Related Products******************************** -->

<section class="products Related-products section" *ngIf="relatedProducts">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-6">
        <div class="title text-center m-5">
          <h2>You May Like That !!</h2>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="row">
        <div class="col-3 mt-2 card-wrapper" *ngFor="let p of relatedProducts">
          <div class="card ">
            <div class="card-body">
              <div class="sale"*ngIf="p.price != p.priceAfter">{{ p.discount }}% OFF</div>
              <div class="card-img-actions">
                <img
                 src="{{ p.image }}"
                  class="card-img img-fluid"
                  width="50"
                  height="200"
                  alt=""
                />
              </div>
            </div>
            <div class="card-body bg-light text-center">
              <div class="mb-2">
                <h5 class="font-weight-semibold mb-2">
                  <a
                        (click)="openRelatedProductDetails(p)"
                          routerLink="/Products/{{ p.id }}"
                          class="text-default mb-2"
                          data-abc="true" >
                           {{ p.name }} 
                  </a>
            
                </h5>
              </div>
              <h4 class="mb-0 font-weight-semibold">${{ p.priceAfter }}</h4>
              <h5 class="oldPrice"*ngIf="p.price != p.priceAfter">${{ p.price }}</h5>
              <div>
                <p>
                  Rating :
                  <div class="stars">
                    <ul class="list-unstyled d-flex justify-content-center">
                      <ng-container *ngIf="p.avgRatingRounded > 0; else emptyStars">
                        <li *ngFor="let star of generateStars(p.avgRatingRounded)">
                          <i class="fas fa-star fa-sm text-warning" [ngClass]="{'fa-star': star === 'full', 'fa-star-half-alt': star === 'half', 'fa-star-o': star === 'empty'}"></i>
                        </li>
                      </ng-container>
                      <ng-template #emptyStars>
                        <li *ngFor="let _ of [1, 2, 3, 4, 5]">
                          <i class="fas fa-star fa-sm fa-star-o"></i>
                        </li>
                      </ng-template>
                    </ul>
                  </div>
                  
              </div>
              <div class="text-muted mb-3">{{ p.reviewCount }} reviews</div>
              
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

